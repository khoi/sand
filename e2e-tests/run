#!/bin/bash
set -euo pipefail

ROOT=$(cd "$(dirname "$0")/.." && pwd -P)
export ROOT

swift build -c release >/dev/null

export SAND_BIN="$ROOT/.build/release/sand"

status=0
for t in "$ROOT"/e2e-tests/cases/*.t; do
  printf '%s\n' "run $t" >&2
  bash "$t" || status=$?
done
exit "$status"
