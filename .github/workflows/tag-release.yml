name: Create Release on Tag
on:
  push:
    tags:
      - "v*"
permissions:
  contents: write
jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Ensure release exists
        env:
          GH_TOKEN: ${{ github.token }}
          TAG: ${{ github.ref_name }}
        run: |
          set -euo pipefail
          if gh release view "$TAG" > /dev/null 2>&1; then
            echo "release exists for $TAG"
            exit 0
          fi
          gh release create "$TAG" --generate-notes
